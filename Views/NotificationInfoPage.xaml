<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MedicinesTracker.Views.NotificationInfoPage"
             xmlns:viewModels="clr-namespace:MedicinesTracker.ViewModels"
             xmlns:models="clr-namespace:MedicinesTracker.Models.Dto"
             x:DataType="viewModels:NotificationInfoVM"
             Title="График приёма лекарства">

    <VerticalStackLayout>
        <!-- Основной CollectionView: группы по частоте -->
        <CollectionView ItemsSource="{Binding GroupedReminders}"
                        EmptyView="Напоминания не найдены">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:GroupedReminderDto">
                    <VerticalStackLayout Spacing="10">
                        <!-- Заголовок группы: частота -->
                        <VerticalStackLayout Spacing="5">
                            <Label 
                                Text="Частота приёма:"
                                Style="{StaticResource CardDescriptionStyle}"/>
                            <Entry
                                Text="{Binding FrequencyName}"
                                Style="{StaticResource EditFieldStyle}"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Spacing="5">
                            <Label 
                                Text="Дата начала приёма:"
                                Style="{StaticResource CardDescriptionStyle}"/>
                            <Entry
                                Text="{Binding DateStart}"
                                Style="{StaticResource EditFieldStyle}"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Spacing="5">
                            <Label 
                                Text="Дата завершения приёма:"
                                Style="{StaticResource CardDescriptionStyle}"/>
                            <Entry
                                Text="{Binding DateEnd}"
                                Style="{StaticResource EditFieldStyle}"/>
                        </VerticalStackLayout>
                        <!-- Вложенный CollectionView: напоминания внутри группы -->
                        <Label Text="Время:" Style="{StaticResource CardDescriptionStyle}"/>
                        <CollectionView ItemsSource="{Binding Reminders}">
                            <CollectionView.ItemTemplate>
                                <DataTemplate x:DataType="models:ReminderDto">
                                    <Border Style="{StaticResource MedicineCardBorderStyle}">
                                        <VerticalStackLayout Spacing="10">
                                            <Label Text="{Binding Time}" Style="{StaticResource EditFieldStyle}"/>
                                        </VerticalStackLayout>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </VerticalStackLayout>
</ContentPage>
